<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9"/>
<title>mOS API description: core/src/include/mos_api.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">mOS API description
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_90fd98a0ba30abf7a6068a44995d2d6b.html">src</a></li><li class="navelem"><a class="el" href="dir_0470aec590e782884f4f3c0a42a193f0.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">mos_api.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mos__api_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef __MOS_API_H_</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define __MOS_API_H_</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#ifdef DARWIN</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;netinet/tcp.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;netinet/if_ether.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;linux/tcp.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;linux/if_ether.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;netinet/in.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;arpa/inet.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;netinet/ip.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span> <span class="comment">/* for offsetof */</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mtcp__epoll_8h.html">mtcp_epoll.h</a>&quot;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#ifndef __MTCP_MANAGER</span></div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a978604454af028b331488dfa3daa71d4">   19</a></span>&#160;<span class="preprocessor">#define __MTCP_MANAGER</span></div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a606e5bfc2a3004b5e3cc5c0832b1311e">   20</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>mtcp_manager * <a class="code" href="mos__api_8h.html#a606e5bfc2a3004b5e3cc5c0832b1311e">mtcp_manager_t</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef __SOCKET_MAP</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a963f175ee6d4598f6beab86a0c7d0083">   23</a></span>&#160;<span class="preprocessor">#define __SOCKET_MAP</span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aea476099c9ac1b5625a26dc9e6d469a8">   24</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>socket_map * <a class="code" href="mos__api_8h.html#aea476099c9ac1b5625a26dc9e6d469a8">socket_map_t</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113">   28</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113">mtcp_hook_point</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;{</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">/* NOTE: The value of hooking points should not overlap with any of</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">     * mos_event_types */</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a9426a16f183cbc135ee25f0d60542e2f">   35</a></span>&#160;    <a class="code" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a9426a16f183cbc135ee25f0d60542e2f">MOS_NULL</a>    = (1 &lt;&lt; 29),</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a4401938e02f5dc902e44e652e7e20753">   37</a></span>&#160;    <a class="code" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a4401938e02f5dc902e44e652e7e20753">MOS_HK_RCV</a>     = (1 &lt;&lt; 30),</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a3b44243105351118a3abf5c27dbef35b">   39</a></span>&#160;    <a class="code" href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a3b44243105351118a3abf5c27dbef35b">MOS_HK_SND</a>  = (1 &lt;&lt; 31),</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;};</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0">   43</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0">mos_event_type</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a3b831e0fc2d31abed5830a98932de67a">   46</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a3b831e0fc2d31abed5830a98932de67a">MOS_NULL_EVENT</a>          = (0),</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">/* mos-defined tcp build-in events */</span></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a1751478d78b2a803cf6bdbcf52238da9">   49</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a1751478d78b2a803cf6bdbcf52238da9">MOS_ON_PKT_IN</a>       = (0x1&lt;&lt;0),</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">/* THIS EVENT IS NOW DEPRECATED (USED ONLY FOR DEBUGGING) */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a871cd398c491bdc45ef8f75066d44776">   52</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a871cd398c491bdc45ef8f75066d44776">MOS_ON_PKT_OUT</a>      = (0x1&lt;&lt;1),</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a16e761d75f33b39277f295ac29b842fa">   59</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a16e761d75f33b39277f295ac29b842fa">MOS_ON_CONN_START</a>   = (0x1&lt;&lt;2),</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">/* THIS EVENT IS NOW DEPRECATED */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a23e6f33184f7b409fa2bc29048c88f5d">   64</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a23e6f33184f7b409fa2bc29048c88f5d">MOS_ON_CONN_SETUP</a>   = (0x1&lt;&lt;3),</div>
<div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a7a41c540b06386a84800454abfe74a3b">   68</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a7a41c540b06386a84800454abfe74a3b">MOS_ON_CONN_NEW_DATA</a>    = (0x1&lt;&lt;4),</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0abe288d81191ad648dc75370e932592e3">   71</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0abe288d81191ad648dc75370e932592e3">MOS_ON_ERROR</a>        = (0x1&lt;&lt;5),</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a57c9e6dacb8ed4a4fc457ba7fcc60598">   75</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a57c9e6dacb8ed4a4fc457ba7fcc60598">MOS_ON_TIMEOUT</a>      = (0x1&lt;&lt;6),</div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a4453d5c687fb7adf6737b2a3e2ef4a43">   77</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a4453d5c687fb7adf6737b2a3e2ef4a43">MOS_ON_TCP_STATE_CHANGE</a> = (0x1&lt;&lt;7),</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0abcd34c973e5569dfc054edbb8e1620e6">   79</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0abcd34c973e5569dfc054edbb8e1620e6">MOS_ON_ORPHAN</a>       = (0x1&lt;&lt;8),</div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a6c97d773b78bf6c7f68480a8a1a8a705">   81</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a6c97d773b78bf6c7f68480a8a1a8a705">MOS_ON_REXMIT</a>           = (0x1&lt;&lt;9),</div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a592661443f4272c39d802ae7f6da10dd">   87</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a592661443f4272c39d802ae7f6da10dd">MOS_ON_CONN_END</a>     = (0x1&lt;&lt;10),</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a9fbcf6f919d13f6430e0f765eac829fd">   90</a></span>&#160;    <a class="code" href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a9fbcf6f919d13f6430e0f765eac829fd">MOS_ON_DEBUG_MESSAGE</a>  = (0x1&lt;&lt;11),</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;};</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">#if 0</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">/* This may go away in future revisions */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="keyword">typedef</span> <span class="keyword">union </span>event_data {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    uint32_t u32;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    uint64_t u64;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keywordtype">void</span> *ptr;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;} event_data_t;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">/* Macros for updating packet context */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="mos__api_8h.html#ac01c6425d6ac6dde29c0cb40c7c1be35">  103</a></span>&#160;<span class="preprocessor">#define MOS_ETH_HDR     (1 &lt;&lt; 0)</span></div>
<div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6bc07a753210bc44515001485fdbaa71">  104</a></span>&#160;<span class="preprocessor">#define MOS_IP_HDR      (1 &lt;&lt; 1)</span></div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="mos__api_8h.html#ab2187ff6e8393d9a58f7b634764dd193">  105</a></span>&#160;<span class="preprocessor">#define MOS_TCP_HDR     (1 &lt;&lt; 2)</span></div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="mos__api_8h.html#ab79c05526d7bb0c1580e9e734e02f8cf">  106</a></span>&#160;<span class="preprocessor">#define MOS_TCP_PAYLOAD     (1 &lt;&lt; 3)</span></div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="mos__api_8h.html#ae2781f79353a147d800b19ebaa796be7">  107</a></span>&#160;<span class="preprocessor">#define MOS_UPDATE_IP_CHKSUM    (1 &lt;&lt; 4)</span></div>
<div class="line"><a name="l00108"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a00b9b03e94e5a42afd5151d47efed016">  108</a></span>&#160;<span class="preprocessor">#define MOS_UPDATE_TCP_CHKSUM   (1 &lt;&lt; 5)</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a8255616d8d353e823d0665edd6ef2b84">  109</a></span>&#160;<span class="preprocessor">#define MOS_DROP        (1 &lt;&lt; 6)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a4e66de52de09c9d0d04d2955072e0349">  110</a></span>&#160;<span class="preprocessor">#define MOS_OVERWRITE       (1 &lt;&lt; 7)</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aa431102b21a02712c3ec63a692d50fcb">  111</a></span>&#160;<span class="preprocessor">#define MOS_CHOMP       (1 &lt;&lt; 8)</span></div>
<div class="line"><a name="l00112"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a12666912c7d4cf9cea0f6e84093197ed">  112</a></span>&#160;<span class="preprocessor">#define MOS_INSERT      (1 &lt;&lt; 9)</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="structpkt__info.html">  122</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpkt__info.html">pkt_info</a> {</div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="structpkt__info.html#ab7dadebb7b3d61e4dedacc1e76d3d667">  123</a></span>&#160;    uint32_t      <a class="code" href="structpkt__info.html#ab7dadebb7b3d61e4dedacc1e76d3d667">cur_ts</a>;    </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">/* ETH */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno"><a class="line" href="structpkt__info.html#aabd532e84c34a180b217717fdb1fc29d">  126</a></span>&#160;    uint16_t      <a class="code" href="structpkt__info.html#aabd532e84c34a180b217717fdb1fc29d">eth_len</a>;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="comment">/* IP */</span></div>
<div class="line"><a name="l00129"></a><span class="lineno"><a class="line" href="structpkt__info.html#a841f8cd1ab793f137cbd53721f7c64cc">  129</a></span>&#160;    uint16_t      <a class="code" href="structpkt__info.html#a841f8cd1ab793f137cbd53721f7c64cc">ip_len</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">/* TCP */</span></div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="structpkt__info.html#aeadafb3f4c2bb9d1a926eb340e284eec">  132</a></span>&#160;    uint64_t      <a class="code" href="structpkt__info.html#aeadafb3f4c2bb9d1a926eb340e284eec">offset</a>;    </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structpkt__info.html#a2590f039d31f29e59c0cb8d700eec499">  133</a></span>&#160;    uint16_t      <a class="code" href="structpkt__info.html#a2590f039d31f29e59c0cb8d700eec499">payloadlen</a>;</div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="structpkt__info.html#ad930bae0a945573b7ddf663276b3cb51">  134</a></span>&#160;    uint32_t      <a class="code" href="structpkt__info.html#ad930bae0a945573b7ddf663276b3cb51">seq</a>;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="structpkt__info.html#a2528c4b87e44496e708d03e1fa217f3a">  135</a></span>&#160;    uint32_t      <a class="code" href="structpkt__info.html#a2528c4b87e44496e708d03e1fa217f3a">ack_seq</a>;</div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="structpkt__info.html#a455911051c32d2a983470fd7d05f27b7">  136</a></span>&#160;    uint16_t      <a class="code" href="structpkt__info.html#a455911051c32d2a983470fd7d05f27b7">window</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">/* ~~ 28 byte boundary ~~ */</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     * CAUTION!!!</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">     * It is extremely critical that the last 5 fields (ethh .. frame)</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">     * are always placed at the end of the definition. MOS relies on</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">     * this specific arrangement when it is creating a new instantiation</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">     * of pctx during mtcp_getlastpkt() invocation.</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="structpkt__info.html#a95561c68a1275e4ae1dbaf4131627b74">  147</a></span>&#160;    <span class="keyword">struct </span>ethhdr *<a class="code" href="structpkt__info.html#a95561c68a1275e4ae1dbaf4131627b74">ethh</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="structpkt__info.html#ab32fec05abd5d56189cd7dae19b693aa">  148</a></span>&#160;    <span class="keyword">struct </span>iphdr  *<a class="code" href="structpkt__info.html#ab32fec05abd5d56189cd7dae19b693aa">iph</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="structpkt__info.html#a815a957528bbdefcda0ca7abb0066a78">  149</a></span>&#160;    <span class="keyword">struct </span>tcphdr *<a class="code" href="structpkt__info.html#a815a957528bbdefcda0ca7abb0066a78">tcph</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="structpkt__info.html#a0a4995495ed8588b59967b5b2b129411">  150</a></span>&#160;    uint8_t       *<a class="code" href="structpkt__info.html#a0a4995495ed8588b59967b5b2b129411">payload</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;};</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="structpkt__ctx.html">  157</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structpkt__ctx.html">pkt_ctx</a> {</div>
<div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structpkt__ctx.html#a60cc35b34f3d90b74cbb2ef43792856f">  158</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structpkt__info.html">pkt_info</a>  <a class="code" href="structpkt__ctx.html#a60cc35b34f3d90b74cbb2ef43792856f">p</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="structpkt__ctx.html#af3d9841a4dab70439b7963c47d6a5fe5">  160</a></span>&#160;    int8_t        <a class="code" href="structpkt__ctx.html#af3d9841a4dab70439b7963c47d6a5fe5">direction</a>; </div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structpkt__ctx.html#ae361ba4b0a96e518bed318185151b19f">  161</a></span>&#160;    uint8_t       <a class="code" href="structpkt__ctx.html#ae361ba4b0a96e518bed318185151b19f">forward</a>;   </div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structpkt__ctx.html#a2aef5864b58f27c9fce148bbdda92e05">  162</a></span>&#160;    int8_t        <a class="code" href="structpkt__ctx.html#a2aef5864b58f27c9fce148bbdda92e05">in_ifidx</a>;  </div>
<div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structpkt__ctx.html#a5df407bf1c8b6c30922baad4d61c2ae8">  163</a></span>&#160;    int8_t        <a class="code" href="structpkt__ctx.html#a5df407bf1c8b6c30922baad4d61c2ae8">out_ifidx</a>; </div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="line" href="structpkt__ctx.html#a1f1864d79a9b368c2143e288a147cd53">  164</a></span>&#160;    int8_t        <a class="code" href="structpkt__ctx.html#a1f1864d79a9b368c2143e288a147cd53">batch_index</a>; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">/* ~~ 64 byte boundary ~~ */</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;};</div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a97ec256204b8b3b2fe7bf14fe9b0a043">  167</a></span>&#160;<span class="preprocessor">#define PKT_INFO_LEN        offsetof(struct pkt_info, ethh)</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">/* </span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * Sequence number change structure. </span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> * Used for MOS_SEQ_REMAP.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00173"></a><span class="lineno"><a class="line" href="structseq__remap__info.html">  173</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00174"></a><span class="lineno"><a class="line" href="structseq__remap__info.html#a54c89073d6220e437a9f9c8d8bf6c003">  174</a></span>&#160;    int64_t <a class="code" href="structseq__remap__info.html#a54c89073d6220e437a9f9c8d8bf6c003">seq_off</a>;    <span class="comment">/* the amount of sequence number drift */</span></div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="structseq__remap__info.html#a33b59e1b5265cb3ff92184005269b3c9">  175</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structseq__remap__info.html#a33b59e1b5265cb3ff92184005269b3c9">side</a>;       <span class="comment">/* which side does this sequence number change apply to? */</span></div>
<div class="line"><a name="l00176"></a><span class="lineno"><a class="line" href="structseq__remap__info.html#a810429e66ad4eaf335ad9e7c6d710fd7">  176</a></span>&#160;    uint32_t <a class="code" href="structseq__remap__info.html#a810429e66ad4eaf335ad9e7c6d710fd7">base_seq</a>;  <span class="comment">/* seq # of the flow where the actual sequence # translation starts */</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;} <a class="code" href="structseq__remap__info.html">seq_remap_info</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="structfilter__arg.html">  179</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structfilter__arg.html">filter_arg</a> {</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structfilter__arg.html#a2b1bb9a93d2ca8bcb6ec7e5892cc0f85">  180</a></span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="structfilter__arg.html#a2b1bb9a93d2ca8bcb6ec7e5892cc0f85">arg</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno"><a class="line" href="structfilter__arg.html#accf6423cd30f80e1fa7f8960b037584e">  181</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structfilter__arg.html#accf6423cd30f80e1fa7f8960b037584e">len</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;} <a class="code" href="mos__api_8h.html#a35496a2e3879d944aad2453d6135087c">filter_arg_t</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="preprocessor">#ifndef SOL_SOCKET</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">/* Level number for (get/set)sockopt() to apply to socket itself. */</span></div>
<div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a92d045f6ee2f343d6b28830a9fec082e">  190</a></span>&#160;<span class="preprocessor">#define SOL_SOCKET      0xffff  </span><span class="comment">/* options for socket level */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00192"></a><span class="lineno"><a class="line" href="mos__api_8h.html#adea5114318ee6bb740e4e3163f249671">  192</a></span>&#160;<span class="preprocessor">#define SOL_MONSOCKET       0xfffe  </span><span class="comment">/* MOS monitor socket level */</span><span class="preprocessor"></span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8">  228</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8">mos_socket_opts</a> {</div>
<div class="line"><a name="l00229"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ac10db003d57c30a12c44065fa83ad6fc">  229</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ac10db003d57c30a12c44065fa83ad6fc">MOS_FRAGINFO_CLIBUF</a> = 0x01,</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8abdb2ae22e09c899f60617e651a24fb93">  230</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8abdb2ae22e09c899f60617e651a24fb93">MOS_FRAGINFO_SVRBUF</a> = 0x02,</div>
<div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a2d14168db60eb28ca8473d87d531cbbd">  231</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a2d14168db60eb28ca8473d87d531cbbd">MOS_INFO_CLIBUF</a>     = 0x03,</div>
<div class="line"><a name="l00232"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ae42ea6729577a414af1ba0d82399fde8">  232</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ae42ea6729577a414af1ba0d82399fde8">MOS_INFO_SVRBUF</a>     = 0x04,</div>
<div class="line"><a name="l00233"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ab7d5d179708e7c4533e05453957e64af">  233</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ab7d5d179708e7c4533e05453957e64af">MOS_TCP_STATE_CLI</a>   = 0x05,</div>
<div class="line"><a name="l00234"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ae986ab75d2756b4c7df5e17322e4500a">  234</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ae986ab75d2756b4c7df5e17322e4500a">MOS_TCP_STATE_SVR</a>   = 0x06,</div>
<div class="line"><a name="l00235"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a22b3d85f714d7ad582c7ef61a3fce05c">  235</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a22b3d85f714d7ad582c7ef61a3fce05c">MOS_TIMESTAMP</a>       = 0x07,</div>
<div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a62471837c36762b55212673e8cb87d1e">  236</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a62471837c36762b55212673e8cb87d1e">MOS_MONLEVEL</a>        = 0x08,</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8aea49945767334e079bae74de0473d57a">  237</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8aea49945767334e079bae74de0473d57a">MOS_CLIBUF</a>          = 0x09,</div>
<div class="line"><a name="l00238"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a4a9cd3145c63512d31a3953882b7a843">  238</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a4a9cd3145c63512d31a3953882b7a843">MOS_SVRBUF</a>          = 0x0a,</div>
<div class="line"><a name="l00239"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a7e936559d3a68bfaa3b2965e9e50df92">  239</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a7e936559d3a68bfaa3b2965e9e50df92">MOS_SEQ_REMAP</a>       = 0x0b,</div>
<div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a8dd211ce1060bc399fd44421c9f7aa2c">  240</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a8dd211ce1060bc399fd44421c9f7aa2c">MOS_STOP_MON</a>        = 0x0c,</div>
<div class="line"><a name="l00241"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a27b22357288f66648687714ed749b494">  241</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a27b22357288f66648687714ed749b494">MOS_FRAG_CLIBUF</a>     = 0x0d,</div>
<div class="line"><a name="l00242"></a><span class="lineno"><a class="line" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a92b6c33bed3fc762699c629e8ddada9a">  242</a></span>&#160;    <a class="code" href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a92b6c33bed3fc762699c629e8ddada9a">MOS_FRAG_SVRBUF</a>     = 0x0e,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#ifdef OLD_API</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    MOS_NO_CLIBUF       = 0x0f,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    MOS_NO_SVRBUF       = 0x10,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;};</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="structtcp__buf__info.html">  255</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtcp__buf__info.html">tcp_buf_info</a> {</div>
<div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="structtcp__buf__info.html#a71120bd926e22d21d7522de2339b66bc">  257</a></span>&#160;    uint32_t <a class="code" href="structtcp__buf__info.html#a71120bd926e22d21d7522de2339b66bc">tcpbi_init_seq</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="structtcp__buf__info.html#a20189939d9fd0315ac203a7a969e8fe8">  262</a></span>&#160;    uint32_t <a class="code" href="structtcp__buf__info.html#a20189939d9fd0315ac203a7a969e8fe8">tcpbi_last_byte_read</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="structtcp__buf__info.html#aa7524384a7aaea34a42342b07de1cf37">  270</a></span>&#160;    uint32_t <a class="code" href="structtcp__buf__info.html#aa7524384a7aaea34a42342b07de1cf37">tcpbi_next_byte_expected</a>;</div>
<div class="line"><a name="l00276"></a><span class="lineno"><a class="line" href="structtcp__buf__info.html#a8a21760d90c70e7a710fa4bb6ad4c9ec">  276</a></span>&#160;    uint32_t <a class="code" href="structtcp__buf__info.html#a8a21760d90c70e7a710fa4bb6ad4c9ec">tcpbi_last_byte_received</a>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;};</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#ifdef NEWPPEEK</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keyword">struct </span><a class="code" href="structtcp__ring__fragment.html">tcp_ring_fragment</a> {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    uint64_t offset;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    uint32_t <a class="code" href="structtcp__ring__fragment.html#a8e95ef0ecc6b0ee27c451e57ac771494">len</a>;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;};</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno"><a class="line" href="structtcp__ring__fragment.html">  287</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structtcp__ring__fragment.html">tcp_ring_fragment</a> {</div>
<div class="line"><a name="l00289"></a><span class="lineno"><a class="line" href="structtcp__ring__fragment.html#a65906c94f7932aafced748ab69ed5cf7">  289</a></span>&#160;    uint32_t <a class="code" href="structtcp__ring__fragment.html#a65906c94f7932aafced748ab69ed5cf7">seq_num</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno"><a class="line" href="structtcp__ring__fragment.html#a8e95ef0ecc6b0ee27c451e57ac771494">  291</a></span>&#160;    uint32_t <a class="code" href="structtcp__ring__fragment.html#a8e95ef0ecc6b0ee27c451e57ac771494">len</a>;</div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="structtcp__ring__fragment.html#aca420e72e64e54510e7e6e2792cb3def">  293</a></span>&#160;    <span class="keyword">struct </span><a class="code" href="structtcp__ring__fragment.html">tcp_ring_fragment</a> *<a class="code" href="structtcp__ring__fragment.html#aca420e72e64e54510e7e6e2792cb3def">next</a>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;};</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;</div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105">  303</a></span>&#160;<span class="keyword">enum</span> <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105">tcpstate</a></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;{</div>
<div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a680a81a7e7676aef8d747d1e06610633">  305</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a680a81a7e7676aef8d747d1e06610633">TCP_CLOSED</a>      = 0,</div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a1d5749e83dc48175394d862a245f9b9b">  306</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a1d5749e83dc48175394d862a245f9b9b">TCP_LISTEN</a>      = 1,</div>
<div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a8d61cf0dd6dacc41f87a1ed05766365c">  307</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a8d61cf0dd6dacc41f87a1ed05766365c">TCP_SYN_SENT</a>        = 2,</div>
<div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105acc3d7ecdafdfc035eb35b6dc90b2f927">  308</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105acc3d7ecdafdfc035eb35b6dc90b2f927">TCP_SYN_RCVD</a>        = 3,</div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a0e0f72fc96e26fce4543fa99b7235ab4">  309</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a0e0f72fc96e26fce4543fa99b7235ab4">TCP_ESTABLISHED</a>     = 4,</div>
<div class="line"><a name="l00310"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a5b698e85611a8d3ace1499765a7d2cd7">  310</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a5b698e85611a8d3ace1499765a7d2cd7">TCP_FIN_WAIT_1</a>      = 5,</div>
<div class="line"><a name="l00311"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a6ca0e6c4fdbfc3d7027ca6b56aaf671c">  311</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a6ca0e6c4fdbfc3d7027ca6b56aaf671c">TCP_FIN_WAIT_2</a>      = 6,</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a5bbf321fdef3abedd34fc24ddb21a91c">  312</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a5bbf321fdef3abedd34fc24ddb21a91c">TCP_CLOSE_WAIT</a>      = 7,</div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a62d0ebf32025a28195c2d8e87e68f3af">  313</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a62d0ebf32025a28195c2d8e87e68f3af">TCP_CLOSING</a>     = 8,</div>
<div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a3a6ad6b8f47a63d155c55de2b8588759">  314</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a3a6ad6b8f47a63d155c55de2b8588759">TCP_LAST_ACK</a>        = 9,</div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a818b4dbb00c24a101cde418f7ba02710">  315</a></span>&#160;    <a class="code" href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a818b4dbb00c24a101cde418f7ba02710">TCP_TIME_WAIT</a>       = 10</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;};</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="mos__api_8h.html#ab06a4f119625dac0cabf7e072b23f743">  319</a></span>&#160;<span class="keyword">typedef</span> uint64_t <a class="code" href="mos__api_8h.html#ab06a4f119625dac0cabf7e072b23f743">event_t</a>;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba1dfde1210f0ecbf21861dca6652f2cc6">  322</a></span>&#160;<span class="keyword">enum</span> {<a class="code" href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba5ee928ce72598baf10c7ed3a75fd5b44">MOS_SIDE_CLI</a>=0, <a class="code" href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba1dfde1210f0ecbf21861dca6652f2cc6">MOS_SIDE_SVR</a>, <a class="code" href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55bab47cd36b4c58d42c4757ab3935d8d765">MOS_SIDE_BOTH</a>};</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">/* mos callback/filter function type definition */</span></div>
<div class="line"><a name="l00326"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a592d95a854019f52788952d22336cc69">  326</a></span>&#160;<span class="keyword">typedef</span> void (*<a class="code" href="mos__api_8h.html#a592d95a854019f52788952d22336cc69">callback_t</a>)(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;             event_t event, <a class="code" href="structfilter__arg.html">filter_arg_t</a> *arg);</div>
<div class="line"><a name="l00329"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a6f1d26b47ecc9c1264c576efb1536850">  329</a></span>&#160;<span class="keyword">typedef</span> bool (*<a class="code" href="mos__api_8h.html#a6f1d26b47ecc9c1264c576efb1536850">filter_t</a>)(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;               event_t event, <a class="code" href="structfilter__arg.html">filter_arg_t</a> *arg);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">/* Definition of monitor_filter type */</span></div>
<div class="line"><a name="l00334"></a><span class="lineno"><a class="line" href="unionmonitor__filter.html">  334</a></span>&#160;<span class="keyword">union </span><a class="code" href="unionmonitor__filter.html">monitor_filter</a> {</div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="unionmonitor__filter.html#a0abeba83a2e5be3b1e04e0b38272bda0">  336</a></span>&#160;    <span class="keywordtype">char</span> *<a class="code" href="unionmonitor__filter.html#a0abeba83a2e5be3b1e04e0b38272bda0">raw_pkt_filter</a>;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="unionmonitor__filter.html#addcad99a12a749b63e6df15de5e7fafe">  339</a></span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="unionmonitor__filter.html#addcad99a12a749b63e6df15de5e7fafe">stream_syn_filter</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="unionmonitor__filter.html#a3acb35ecd06e9b09f2f8660463da24aa">  340</a></span>&#160;        <span class="keywordtype">char</span> *<a class="code" href="unionmonitor__filter.html#a3acb35ecd06e9b09f2f8660463da24aa">stream_orphan_filter</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    };  </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;};</div>
<div class="line"><a name="l00343"></a><span class="lineno"><a class="line" href="mos__api_8h.html#ac74da39802fdb6e33e2d7011d1d6195e">  343</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">union </span><a class="code" href="unionmonitor__filter.html">monitor_filter</a> *<a class="code" href="mos__api_8h.html#ac74da39802fdb6e33e2d7011d1d6195e">monitor_filter_t</a>;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">/* Assign an address range (specified by ft) to monitor via sock</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"> * (1) If sock is MOS_SOCK_MONITOR_RAW type, ft.raw_pkt_filter is applied to</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment"> *     every packet coming in.</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment"> * (2) If sock is MOS_SOCK_MONITOR_STREAM type,</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment"> *     ft.stream_syn_filter is applied to the first SYN pkt of the flow.</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment"> *     (The succeeding packets of that flow will bypass the filter operation.)</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"> *     ft.stream_orphan_filter is applied to the pkts that don&#39;t belong to any</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"> *     of the existing TCP streams which are being monitored.</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment"> *     (e.g., non-SYN pkt with no identified flow)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"> * [*] ft.stream_syn_filter and ft.stream_orphan_filter should be consisted</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment"> *     only of the following keywords:</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"> *     - &#39;tcp, &#39;host&#39;, &#39;src&#39;, &#39;dst&#39;, &#39;net&#39;, &#39;mask&#39;, &#39;port&#39;, &#39;portrange&#39;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> *     - &#39;and&#39;, &#39;or&#39;, &#39;&amp;&#39;, &#39;|&#39;</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment"> * @param [in] mctx: mtcp context</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"> * @param [in] sock: socket id (should be MOS_SOCK_MONITOR_RAW</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment"> *                   or MOS_SOCK_MONITOR_STREAM type)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment"> * @param [in] cf: Describe a set of connections to accept</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment"> *                 in a BPF (Berkerley Packet Filter) format</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"> *                 NULL if you want to monitor any packet</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"> * @return zero on success, -1 on error</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<a class="code" href="mos__api_8h.html#ae543660aa2d403098a859109e76e4d77">mtcp_bind_monitor_filter</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, monitor_filter_t ft);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<a class="code" href="mos__api_8h.html#a5945e261099bac0039d6e49ad652f178">mtcp_register_callback</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, event_t event,</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                               <span class="keywordtype">int</span> hook_point, <a class="code" href="mos__api_8h.html#a592d95a854019f52788952d22336cc69">callback_t</a> cb);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<a class="code" href="mos__api_8h.html#ae8e940088fba957e4ffe946d1d282bfc">mtcp_unregister_callback</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, event_t event,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                               <span class="keywordtype">int</span> hook_point);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;event_t</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<a class="code" href="mos__api_8h.html#a5881243b8737330a1151ea47ec3ca9ee">mtcp_alloc_event</a>(event_t event);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;event_t</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<a class="code" href="mos__api_8h.html#a76eea0045ac9a91edaa523e95839bf6f">mtcp_define_event</a>(event_t event, <a class="code" href="mos__api_8h.html#a6f1d26b47ecc9c1264c576efb1536850">filter_t</a> filter, <span class="keyword">struct</span> <a class="code" href="structfilter__arg.html">filter_arg</a> *arg);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<a class="code" href="mos__api_8h.html#abed052d4d75f5d217d073a23cf3a8e36">mtcp_raise_event</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, event_t event);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> * Callback only functions</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<a class="code" href="mos__api_8h.html#afd9f2be3b16db2965c043ed7d570c2a8">mtcp_set_uctx</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">void</span> *uctx);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keywordtype">void</span> *</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<a class="code" href="mos__api_8h.html#aef924fe2967e1483507a5e90b4fbf168">mtcp_get_uctx</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;ssize_t</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<a class="code" href="mos__api_8h.html#ac416f8592303eb59e172c94224485986">mtcp_peek</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side,</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> len);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="preprocessor">#ifdef NEWPPEEK</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;ssize_t <a class="code" href="mos__api_8h.html#a9a0d2641d53e54672fd1c2a81bdd8d0c">mtcp_ppeek</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side, </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;              <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count, uint64_t off);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;ssize_t <a class="code" href="mos__api_8h.html#a9a0d2641d53e54672fd1c2a81bdd8d0c">mtcp_ppeek</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side, </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;              <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> count, off_t seq_num);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">/* Use this macro to copy packets when mtcp_getlastpkt is called */</span></div>
<div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="mos__api_8h.html#a44b6ea554d6cff5bb0b52c419683c02a">  489</a></span>&#160;<span class="preprocessor">#define MTCP_CB_GETCURPKT_CREATE_COPY</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<a class="code" href="mos__api_8h.html#a28805ee9f257c75cda9037b7fee7f906">mtcp_getlastpkt</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side, <span class="keyword">struct</span> <a class="code" href="structpkt__info.html">pkt_info</a> *p);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<a class="code" href="mos__api_8h.html#aaad7a65ea9ed07347a7f6a2d502f5945">mtcp_settimer</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> <span class="keywordtype">id</span>, <span class="keyword">struct</span> timeval *timeout, <a class="code" href="mos__api_8h.html#a592d95a854019f52788952d22336cc69">callback_t</a> cb);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;uint32_t</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<a class="code" href="mos__api_8h.html#aa65c9c44e1a928cb5f1643f624cee7a9">mtcp_cb_get_ts</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<a class="code" href="mos__api_8h.html#a181a35077bcf84ab3ec5f3827311b9bd">mtcp_app_join</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<a class="code" href="mos__api_8h.html#a0d07681632738288db8f90a55644e017">mtcp_getpeername</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keyword">struct</span> sockaddr *saddr, socklen_t *addrlen, <span class="keywordtype">int</span> side);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<a class="code" href="mos__api_8h.html#ae29399cfc7025da5fa50bb149c41874d">mtcp_setlastpkt</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock, <span class="keywordtype">int</span> side, off_t offset,</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        <a class="code" href="mtcp__api_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a> *data, uint16_t datalen, <span class="keywordtype">int</span> option);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<a class="code" href="mos__api_8h.html#a7f75ff02c17b0d335d0c670894df4a2c">mtcp_cb_dropcurpkt</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">/* Reset the connection (send RST to both sides)</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> * (This API will be updated after discussion.)</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<a class="code" href="mos__api_8h.html#a5414c55417e8dfda2a91e46eb341e6cd">mtcp_reset_conn</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">int</span> sock);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<a class="code" href="mos__api_8h.html#a190543f87a27a4ec4042f236cb3027ae">mtcp_set_debug_string</a>(<a class="code" href="mos__api_8h.html#a606e5bfc2a3004b5e3cc5c0832b1311e">mtcp_manager_t</a> mtcp, <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt, ...);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="keywordtype">int</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<a class="code" href="mos__api_8h.html#a6f6a3233eeb5df8d42227fc9761058d9">mtcp_get_debug_string</a>(<a class="code" href="structmtcp__context.html">mctx_t</a> mctx, <span class="keywordtype">char</span> *buf, <span class="keywordtype">int</span> len);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* __MOS_API_H_ */</span><span class="preprocessor"></span></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a1d5749e83dc48175394d862a245f9b9b"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a1d5749e83dc48175394d862a245f9b9b">TCP_LISTEN</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:306</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a4453d5c687fb7adf6737b2a3e2ef4a43"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a4453d5c687fb7adf6737b2a3e2ef4a43">MOS_ON_TCP_STATE_CHANGE</a></div><div class="ttdoc">TCP state is being changed. </div><div class="ttdef"><b>Definition:</b> mos_api.h:77</div></div>
<div class="ttc" id="structtcp__buf__info_html"><div class="ttname"><a href="structtcp__buf__info.html">tcp_buf_info</a></div><div class="ttdoc">MOS tcp buf info structure. </div><div class="ttdef"><b>Definition:</b> mos_api.h:255</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8ab7d5d179708e7c4533e05453957e64af"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ab7d5d179708e7c4533e05453957e64af">MOS_TCP_STATE_CLI</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:233</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a92b6c33bed3fc762699c629e8ddada9a"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a92b6c33bed3fc762699c629e8ddada9a">MOS_FRAG_SVRBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:242</div></div>
<div class="ttc" id="mos__api_8h_html_a6f1d26b47ecc9c1264c576efb1536850"><div class="ttname"><a href="mos__api_8h.html#a6f1d26b47ecc9c1264c576efb1536850">filter_t</a></div><div class="ttdeci">bool(* filter_t)(mctx_t mctx, int sock, int side, event_t event, filter_arg_t *arg)</div><div class="ttdoc">Prototype of UDE&#39;s filter function. </div><div class="ttdef"><b>Definition:</b> mos_api.h:329</div></div>
<div class="ttc" id="structpkt__info_html_ad930bae0a945573b7ddf663276b3cb51"><div class="ttname"><a href="structpkt__info.html#ad930bae0a945573b7ddf663276b3cb51">pkt_info::seq</a></div><div class="ttdeci">uint32_t seq</div><div class="ttdef"><b>Definition:</b> mos_api.h:134</div></div>
<div class="ttc" id="mos__api_8h_html_a5945e261099bac0039d6e49ad652f178"><div class="ttname"><a href="mos__api_8h.html#a5945e261099bac0039d6e49ad652f178">mtcp_register_callback</a></div><div class="ttdeci">int mtcp_register_callback(mctx_t mctx, int sock, event_t event, int hook_point, callback_t cb)</div><div class="ttdoc">Register a callback function in hook_point. </div></div>
<div class="ttc" id="structpkt__ctx_html_a2aef5864b58f27c9fce148bbdda92e05"><div class="ttname"><a href="structpkt__ctx.html#a2aef5864b58f27c9fce148bbdda92e05">pkt_ctx::in_ifidx</a></div><div class="ttdeci">int8_t in_ifidx</div><div class="ttdoc">input interface (ro) </div><div class="ttdef"><b>Definition:</b> mos_api.h:162</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a7a41c540b06386a84800454abfe74a3b"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a7a41c540b06386a84800454abfe74a3b">MOS_ON_CONN_NEW_DATA</a></div><div class="ttdoc">New data is now readable. </div><div class="ttdef"><b>Definition:</b> mos_api.h:68</div></div>
<div class="ttc" id="mos__api_8h_html_aea476099c9ac1b5625a26dc9e6d469a8"><div class="ttname"><a href="mos__api_8h.html#aea476099c9ac1b5625a26dc9e6d469a8">socket_map_t</a></div><div class="ttdeci">struct socket_map * socket_map_t</div><div class="ttdef"><b>Definition:</b> mos_api.h:24</div></div>
<div class="ttc" id="structpkt__ctx_html_a60cc35b34f3d90b74cbb2ef43792856f"><div class="ttname"><a href="structpkt__ctx.html#a60cc35b34f3d90b74cbb2ef43792856f">pkt_ctx::p</a></div><div class="ttdeci">struct pkt_info p</div><div class="ttdef"><b>Definition:</b> mos_api.h:158</div></div>
<div class="ttc" id="mos__api_8h_html_a606e5bfc2a3004b5e3cc5c0832b1311e"><div class="ttname"><a href="mos__api_8h.html#a606e5bfc2a3004b5e3cc5c0832b1311e">mtcp_manager_t</a></div><div class="ttdeci">struct mtcp_manager * mtcp_manager_t</div><div class="ttdef"><b>Definition:</b> mos_api.h:20</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a0e0f72fc96e26fce4543fa99b7235ab4"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a0e0f72fc96e26fce4543fa99b7235ab4">TCP_ESTABLISHED</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:309</div></div>
<div class="ttc" id="structtcp__ring__fragment_html_a8e95ef0ecc6b0ee27c451e57ac771494"><div class="ttname"><a href="structtcp__ring__fragment.html#a8e95ef0ecc6b0ee27c451e57ac771494">tcp_ring_fragment::len</a></div><div class="ttdeci">uint32_t len</div><div class="ttdoc">TCP sequence number. </div><div class="ttdef"><b>Definition:</b> mos_api.h:291</div></div>
<div class="ttc" id="structseq__remap__info_html_a54c89073d6220e437a9f9c8d8bf6c003"><div class="ttname"><a href="structseq__remap__info.html#a54c89073d6220e437a9f9c8d8bf6c003">seq_remap_info::seq_off</a></div><div class="ttdeci">int64_t seq_off</div><div class="ttdef"><b>Definition:</b> mos_api.h:174</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8aea49945767334e079bae74de0473d57a"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8aea49945767334e079bae74de0473d57a">MOS_CLIBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:237</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0">mos_event_type</a></div><div class="ttdeci">mos_event_type</div><div class="ttdoc">Built-in events provided by mOS. </div><div class="ttdef"><b>Definition:</b> mos_api.h:43</div></div>
<div class="ttc" id="mos__api_8h_html_a9a0d2641d53e54672fd1c2a81bdd8d0c"><div class="ttname"><a href="mos__api_8h.html#a9a0d2641d53e54672fd1c2a81bdd8d0c">mtcp_ppeek</a></div><div class="ttdeci">ssize_t mtcp_ppeek(mctx_t mctx, int sock, int side, char *buf, size_t count, off_t seq_num)</div><div class="ttdoc">The mtcp_ppeek() function reads up to count bytes from the TCP ring buffer of the monitor socket sock...</div></div>
<div class="ttc" id="structpkt__info_html_aeadafb3f4c2bb9d1a926eb340e284eec"><div class="ttname"><a href="structpkt__info.html#aeadafb3f4c2bb9d1a926eb340e284eec">pkt_info::offset</a></div><div class="ttdeci">uint64_t offset</div><div class="ttdoc">TCP ring buffer offset. </div><div class="ttdef"><b>Definition:</b> mos_api.h:132</div></div>
<div class="ttc" id="mos__api_8h_html_abed052d4d75f5d217d073a23cf3a8e36"><div class="ttname"><a href="mos__api_8h.html#abed052d4d75f5d217d073a23cf3a8e36">mtcp_raise_event</a></div><div class="ttdeci">int mtcp_raise_event(mctx_t mctx, event_t event)</div><div class="ttdoc">Raise a event. </div></div>
<div class="ttc" id="unionmonitor__filter_html_addcad99a12a749b63e6df15de5e7fafe"><div class="ttname"><a href="unionmonitor__filter.html#addcad99a12a749b63e6df15de5e7fafe">monitor_filter::stream_syn_filter</a></div><div class="ttdeci">char * stream_syn_filter</div><div class="ttdef"><b>Definition:</b> mos_api.h:339</div></div>
<div class="ttc" id="structpkt__info_html_a0a4995495ed8588b59967b5b2b129411"><div class="ttname"><a href="structpkt__info.html#a0a4995495ed8588b59967b5b2b129411">pkt_info::payload</a></div><div class="ttdeci">uint8_t * payload</div><div class="ttdef"><b>Definition:</b> mos_api.h:150</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8">mos_socket_opts</a></div><div class="ttdeci">mos_socket_opts</div><div class="ttdoc">MOS monitor socket option names (and values) This will contain options pertaining to monitor stream s...</div><div class="ttdef"><b>Definition:</b> mos_api.h:228</div></div>
<div class="ttc" id="structpkt__info_html_a95561c68a1275e4ae1dbaf4131627b74"><div class="ttname"><a href="structpkt__info.html#a95561c68a1275e4ae1dbaf4131627b74">pkt_info::ethh</a></div><div class="ttdeci">struct ethhdr * ethh</div><div class="ttdef"><b>Definition:</b> mos_api.h:147</div></div>
<div class="ttc" id="structseq__remap__info_html_a810429e66ad4eaf335ad9e7c6d710fd7"><div class="ttname"><a href="structseq__remap__info.html#a810429e66ad4eaf335ad9e7c6d710fd7">seq_remap_info::base_seq</a></div><div class="ttdeci">uint32_t base_seq</div><div class="ttdef"><b>Definition:</b> mos_api.h:176</div></div>
<div class="ttc" id="mos__api_8h_html_a28805ee9f257c75cda9037b7fee7f906"><div class="ttname"><a href="mos__api_8h.html#a28805ee9f257c75cda9037b7fee7f906">mtcp_getlastpkt</a></div><div class="ttdeci">int mtcp_getlastpkt(mctx_t mctx, int sock, int side, struct pkt_info *p)</div><div class="ttdoc">Get current packet of mtcp context. </div></div>
<div class="ttc" id="mos__api_8h_html_a5881243b8737330a1151ea47ec3ca9ee"><div class="ttname"><a href="mos__api_8h.html#a5881243b8737330a1151ea47ec3ca9ee">mtcp_alloc_event</a></div><div class="ttdeci">event_t mtcp_alloc_event(event_t event)</div><div class="ttdoc">Allocate a child event. </div></div>
<div class="ttc" id="mos__api_8h_html_a76eea0045ac9a91edaa523e95839bf6f"><div class="ttname"><a href="mos__api_8h.html#a76eea0045ac9a91edaa523e95839bf6f">mtcp_define_event</a></div><div class="ttdeci">event_t mtcp_define_event(event_t event, filter_t filter, struct filter_arg *arg)</div><div class="ttdoc">Define a user-defined event function. </div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a818b4dbb00c24a101cde418f7ba02710"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a818b4dbb00c24a101cde418f7ba02710">TCP_TIME_WAIT</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:315</div></div>
<div class="ttc" id="structseq__remap__info_html"><div class="ttname"><a href="structseq__remap__info.html">seq_remap_info</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:173</div></div>
<div class="ttc" id="structpkt__ctx_html_a1f1864d79a9b368c2143e288a147cd53"><div class="ttname"><a href="structpkt__ctx.html#a1f1864d79a9b368c2143e288a147cd53">pkt_ctx::batch_index</a></div><div class="ttdeci">int8_t batch_index</div><div class="ttdoc">index of packet in the rx batch </div><div class="ttdef"><b>Definition:</b> mos_api.h:164</div></div>
<div class="ttc" id="mos__api_8h_html_aaad7a65ea9ed07347a7f6a2d502f5945"><div class="ttname"><a href="mos__api_8h.html#aaad7a65ea9ed07347a7f6a2d502f5945">mtcp_settimer</a></div><div class="ttdeci">int mtcp_settimer(mctx_t mctx, int id, struct timeval *timeout, callback_t cb)</div><div class="ttdoc">Register user&#39;s custom timer. </div></div>
<div class="ttc" id="structpkt__ctx_html"><div class="ttname"><a href="structpkt__ctx.html">pkt_ctx</a></div><div class="ttdoc">PACKET CONTEXT is the packet structure that goes through the mOS core... </div><div class="ttdef"><b>Definition:</b> mos_api.h:157</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a6ca0e6c4fdbfc3d7027ca6b56aaf671c"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a6ca0e6c4fdbfc3d7027ca6b56aaf671c">TCP_FIN_WAIT_2</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:311</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105acc3d7ecdafdfc035eb35b6dc90b2f927"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105acc3d7ecdafdfc035eb35b6dc90b2f927">TCP_SYN_RCVD</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:308</div></div>
<div class="ttc" id="mos__api_8h_html_a592d95a854019f52788952d22336cc69"><div class="ttname"><a href="mos__api_8h.html#a592d95a854019f52788952d22336cc69">callback_t</a></div><div class="ttdeci">void(* callback_t)(mctx_t mctx, int sock, int side, event_t event, filter_arg_t *arg)</div><div class="ttdoc">Prototype of callback function. </div><div class="ttdef"><b>Definition:</b> mos_api.h:326</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8ac10db003d57c30a12c44065fa83ad6fc"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ac10db003d57c30a12c44065fa83ad6fc">MOS_FRAGINFO_CLIBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:229</div></div>
<div class="ttc" id="structtcp__ring__fragment_html_a65906c94f7932aafced748ab69ed5cf7"><div class="ttname"><a href="structtcp__ring__fragment.html#a65906c94f7932aafced748ab69ed5cf7">tcp_ring_fragment::seq_num</a></div><div class="ttdeci">uint32_t seq_num</div><div class="ttdoc">TCP sequence number of the packet. </div><div class="ttdef"><b>Definition:</b> mos_api.h:289</div></div>
<div class="ttc" id="mos__api_8h_html_a7d2d06e2b79da6a940cf1f22e2dd3113"><div class="ttname"><a href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113">mtcp_hook_point</a></div><div class="ttdeci">mtcp_hook_point</div><div class="ttdoc">Available hooking points. </div><div class="ttdef"><b>Definition:</b> mos_api.h:28</div></div>
<div class="ttc" id="mos__api_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba5ee928ce72598baf10c7ed3a75fd5b44"><div class="ttname"><a href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba5ee928ce72598baf10c7ed3a75fd5b44">MOS_SIDE_CLI</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:322</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a5b698e85611a8d3ace1499765a7d2cd7"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a5b698e85611a8d3ace1499765a7d2cd7">TCP_FIN_WAIT_1</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:310</div></div>
<div class="ttc" id="structpkt__info_html_a815a957528bbdefcda0ca7abb0066a78"><div class="ttname"><a href="structpkt__info.html#a815a957528bbdefcda0ca7abb0066a78">pkt_info::tcph</a></div><div class="ttdeci">struct tcphdr * tcph</div><div class="ttdef"><b>Definition:</b> mos_api.h:149</div></div>
<div class="ttc" id="mos__api_8h_html_aa65c9c44e1a928cb5f1643f624cee7a9"><div class="ttname"><a href="mos__api_8h.html#aa65c9c44e1a928cb5f1643f624cee7a9">mtcp_cb_get_ts</a></div><div class="ttdeci">uint32_t mtcp_cb_get_ts(mctx_t mctx)</div><div class="ttdoc">A sibling function to mtcp_settimer that returns the current timestamp of the machine in microseconds...</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a8d61cf0dd6dacc41f87a1ed05766365c"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a8d61cf0dd6dacc41f87a1ed05766365c">TCP_SYN_SENT</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:307</div></div>
<div class="ttc" id="unionmonitor__filter_html_a0abeba83a2e5be3b1e04e0b38272bda0"><div class="ttname"><a href="unionmonitor__filter.html#a0abeba83a2e5be3b1e04e0b38272bda0">monitor_filter::raw_pkt_filter</a></div><div class="ttdeci">char * raw_pkt_filter</div><div class="ttdoc">For MOS_SOCK_MONITOR_RAW type socket. </div><div class="ttdef"><b>Definition:</b> mos_api.h:336</div></div>
<div class="ttc" id="mos__api_8h_html_a35496a2e3879d944aad2453d6135087c"><div class="ttname"><a href="mos__api_8h.html#a35496a2e3879d944aad2453d6135087c">filter_arg_t</a></div><div class="ttdeci">struct filter_arg filter_arg_t</div></div>
<div class="ttc" id="structfilter__arg_html"><div class="ttname"><a href="structfilter__arg.html">filter_arg</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:179</div></div>
<div class="ttc" id="structtcp__buf__info_html_a20189939d9fd0315ac203a7a969e8fe8"><div class="ttname"><a href="structtcp__buf__info.html#a20189939d9fd0315ac203a7a969e8fe8">tcp_buf_info::tcpbi_last_byte_read</a></div><div class="ttdeci">uint32_t tcpbi_last_byte_read</div><div class="ttdoc">TCP sequence number of the &#39;last byte of payload that has already been read by the end application&#39; (...</div><div class="ttdef"><b>Definition:</b> mos_api.h:262</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a57c9e6dacb8ed4a4fc457ba7fcc60598"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a57c9e6dacb8ed4a4fc457ba7fcc60598">MOS_ON_TIMEOUT</a></div><div class="ttdoc">No packet is seen for a long time. </div><div class="ttdef"><b>Definition:</b> mos_api.h:75</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a9fbcf6f919d13f6430e0f765eac829fd"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a9fbcf6f919d13f6430e0f765eac829fd">MOS_ON_DEBUG_MESSAGE</a></div><div class="ttdoc">This event is for debugging. </div><div class="ttdef"><b>Definition:</b> mos_api.h:90</div></div>
<div class="ttc" id="structtcp__buf__info_html_a8a21760d90c70e7a710fa4bb6ad4c9ec"><div class="ttname"><a href="structtcp__buf__info.html#a8a21760d90c70e7a710fa4bb6ad4c9ec">tcp_buf_info::tcpbi_last_byte_received</a></div><div class="ttdeci">uint32_t tcpbi_last_byte_received</div><div class="ttdoc">TCP sequence number of the &#39;last byte of the payload that is currently stored&#39; in the TCP ring buffer...</div><div class="ttdef"><b>Definition:</b> mos_api.h:276</div></div>
<div class="ttc" id="structpkt__info_html_aabd532e84c34a180b217717fdb1fc29d"><div class="ttname"><a href="structpkt__info.html#aabd532e84c34a180b217717fdb1fc29d">pkt_info::eth_len</a></div><div class="ttdeci">uint16_t eth_len</div><div class="ttdef"><b>Definition:</b> mos_api.h:126</div></div>
<div class="ttc" id="mos__api_8h_html_ae543660aa2d403098a859109e76e4d77"><div class="ttname"><a href="mos__api_8h.html#ae543660aa2d403098a859109e76e4d77">mtcp_bind_monitor_filter</a></div><div class="ttdeci">int mtcp_bind_monitor_filter(mctx_t mctx, int sock, monitor_filter_t ft)</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a62471837c36762b55212673e8cb87d1e"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a62471837c36762b55212673e8cb87d1e">MOS_MONLEVEL</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:236</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105">tcpstate</a></div><div class="ttdeci">tcpstate</div><div class="ttdoc">mOS tcp stream states. </div><div class="ttdef"><b>Definition:</b> mos_api.h:303</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a3a6ad6b8f47a63d155c55de2b8588759"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a3a6ad6b8f47a63d155c55de2b8588759">TCP_LAST_ACK</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:314</div></div>
<div class="ttc" id="structpkt__ctx_html_af3d9841a4dab70439b7963c47d6a5fe5"><div class="ttname"><a href="structpkt__ctx.html#af3d9841a4dab70439b7963c47d6a5fe5">pkt_ctx::direction</a></div><div class="ttdeci">int8_t direction</div><div class="ttdoc">where does this packet originate from? (ro) </div><div class="ttdef"><b>Definition:</b> mos_api.h:160</div></div>
<div class="ttc" id="structtcp__buf__info_html_aa7524384a7aaea34a42342b07de1cf37"><div class="ttname"><a href="structtcp__buf__info.html#aa7524384a7aaea34a42342b07de1cf37">tcp_buf_info::tcpbi_next_byte_expected</a></div><div class="ttdeci">uint32_t tcpbi_next_byte_expected</div><div class="ttdoc">TCP sequence number of the &#39;last byte of the payload that is currently buffered and needs to be read ...</div><div class="ttdef"><b>Definition:</b> mos_api.h:270</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8ae42ea6729577a414af1ba0d82399fde8"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ae42ea6729577a414af1ba0d82399fde8">MOS_INFO_SVRBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:232</div></div>
<div class="ttc" id="unionmonitor__filter_html_a3acb35ecd06e9b09f2f8660463da24aa"><div class="ttname"><a href="unionmonitor__filter.html#a3acb35ecd06e9b09f2f8660463da24aa">monitor_filter::stream_orphan_filter</a></div><div class="ttdeci">char * stream_orphan_filter</div><div class="ttdef"><b>Definition:</b> mos_api.h:340</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a8dd211ce1060bc399fd44421c9f7aa2c"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a8dd211ce1060bc399fd44421c9f7aa2c">MOS_STOP_MON</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:240</div></div>
<div class="ttc" id="unionmonitor__filter_html"><div class="ttname"><a href="unionmonitor__filter.html">monitor_filter</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:334</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a23e6f33184f7b409fa2bc29048c88f5d"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a23e6f33184f7b409fa2bc29048c88f5d">MOS_ON_CONN_SETUP</a></div><div class="ttdoc">3-way handshake is finished. </div><div class="ttdef"><b>Definition:</b> mos_api.h:64</div></div>
<div class="ttc" id="structpkt__ctx_html_ae361ba4b0a96e518bed318185151b19f"><div class="ttname"><a href="structpkt__ctx.html#ae361ba4b0a96e518bed318185151b19f">pkt_ctx::forward</a></div><div class="ttdeci">uint8_t forward</div><div class="ttdoc">0: drop, 1: forward to out_ifidx (rw) </div><div class="ttdef"><b>Definition:</b> mos_api.h:161</div></div>
<div class="ttc" id="mos__api_8h_html_a7d2d06e2b79da6a940cf1f22e2dd3113a3b44243105351118a3abf5c27dbef35b"><div class="ttname"><a href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a3b44243105351118a3abf5c27dbef35b">MOS_HK_SND</a></div><div class="ttdoc">Hooking point after TCP sender. </div><div class="ttdef"><b>Definition:</b> mos_api.h:39</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a16e761d75f33b39277f295ac29b842fa"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a16e761d75f33b39277f295ac29b842fa">MOS_ON_CONN_START</a></div><div class="ttdoc">SYN packet as seen by the monitor client side: activated when the client state is set to SYN_SENT ser...</div><div class="ttdef"><b>Definition:</b> mos_api.h:59</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a22b3d85f714d7ad582c7ef61a3fce05c"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a22b3d85f714d7ad582c7ef61a3fce05c">MOS_TIMESTAMP</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:235</div></div>
<div class="ttc" id="mos__api_8h_html_ae29399cfc7025da5fa50bb149c41874d"><div class="ttname"><a href="mos__api_8h.html#ae29399cfc7025da5fa50bb149c41874d">mtcp_setlastpkt</a></div><div class="ttdeci">int mtcp_setlastpkt(mctx_t mctx, int sock, int side, off_t offset, byte *data, uint16_t datalen, int option)</div><div class="ttdoc">Updates the Ethernet frame at a given offset across datalen bytes. </div></div>
<div class="ttc" id="mos__api_8h_html_a7f75ff02c17b0d335d0c670894df4a2c"><div class="ttname"><a href="mos__api_8h.html#a7f75ff02c17b0d335d0c670894df4a2c">mtcp_cb_dropcurpkt</a></div><div class="ttdeci">int mtcp_cb_dropcurpkt(mctx_t mctx)</div><div class="ttdoc">Drop current packet (don&#39;t forward it to the peer node) </div></div>
<div class="ttc" id="mos__api_8h_html_ab06a4f119625dac0cabf7e072b23f743"><div class="ttname"><a href="mos__api_8h.html#ab06a4f119625dac0cabf7e072b23f743">event_t</a></div><div class="ttdeci">uint64_t event_t</div><div class="ttdoc">Definition of event type. </div><div class="ttdef"><b>Definition:</b> mos_api.h:319</div></div>
<div class="ttc" id="structtcp__ring__fragment_html_aca420e72e64e54510e7e6e2792cb3def"><div class="ttname"><a href="structtcp__ring__fragment.html#aca420e72e64e54510e7e6e2792cb3def">tcp_ring_fragment::next</a></div><div class="ttdeci">struct tcp_ring_fragment * next</div><div class="ttdoc">points the next fragment argument, NULL if it is the end of the list </div><div class="ttdef"><b>Definition:</b> mos_api.h:293</div></div>
<div class="ttc" id="mos__api_8h_html_afd9f2be3b16db2965c043ed7d570c2a8"><div class="ttname"><a href="mos__api_8h.html#afd9f2be3b16db2965c043ed7d570c2a8">mtcp_set_uctx</a></div><div class="ttdeci">void mtcp_set_uctx(mctx_t mctx, int sock, void *uctx)</div><div class="ttdoc">Set user-level context (e.g., to store any per-flow user-defined meatadata) </div></div>
<div class="ttc" id="structpkt__info_html_a841f8cd1ab793f137cbd53721f7c64cc"><div class="ttname"><a href="structpkt__info.html#a841f8cd1ab793f137cbd53721f7c64cc">pkt_info::ip_len</a></div><div class="ttdeci">uint16_t ip_len</div><div class="ttdef"><b>Definition:</b> mos_api.h:129</div></div>
<div class="ttc" id="mos__api_8h_html_a06fc87d81c62e9abb8790b6e5713c55ba1dfde1210f0ecbf21861dca6652f2cc6"><div class="ttname"><a href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55ba1dfde1210f0ecbf21861dca6652f2cc6">MOS_SIDE_SVR</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:322</div></div>
<div class="ttc" id="structpkt__info_html_a2590f039d31f29e59c0cb8d700eec499"><div class="ttname"><a href="structpkt__info.html#a2590f039d31f29e59c0cb8d700eec499">pkt_info::payloadlen</a></div><div class="ttdeci">uint16_t payloadlen</div><div class="ttdef"><b>Definition:</b> mos_api.h:133</div></div>
<div class="ttc" id="mtcp__epoll_8h_html"><div class="ttname"><a href="mtcp__epoll_8h.html">mtcp_epoll.h</a></div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a5bbf321fdef3abedd34fc24ddb21a91c"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a5bbf321fdef3abedd34fc24ddb21a91c">TCP_CLOSE_WAIT</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:312</div></div>
<div class="ttc" id="mos__api_8h_html_aef924fe2967e1483507a5e90b4fbf168"><div class="ttname"><a href="mos__api_8h.html#aef924fe2967e1483507a5e90b4fbf168">mtcp_get_uctx</a></div><div class="ttdeci">void * mtcp_get_uctx(mctx_t mctx, int sock)</div><div class="ttdoc">Get user-level context (e.g., to retrieve user-defined metadata stored in mtcp_set_uctx()) ...</div></div>
<div class="ttc" id="structpkt__info_html_a2528c4b87e44496e708d03e1fa217f3a"><div class="ttname"><a href="structpkt__info.html#a2528c4b87e44496e708d03e1fa217f3a">pkt_info::ack_seq</a></div><div class="ttdeci">uint32_t ack_seq</div><div class="ttdef"><b>Definition:</b> mos_api.h:135</div></div>
<div class="ttc" id="mos__api_8h_html_a190543f87a27a4ec4042f236cb3027ae"><div class="ttname"><a href="mos__api_8h.html#a190543f87a27a4ec4042f236cb3027ae">mtcp_set_debug_string</a></div><div class="ttdeci">int mtcp_set_debug_string(mtcp_manager_t mtcp, const char *fmt,...)</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a2d14168db60eb28ca8473d87d531cbbd"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a2d14168db60eb28ca8473d87d531cbbd">MOS_INFO_CLIBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:231</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a62d0ebf32025a28195c2d8e87e68f3af"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a62d0ebf32025a28195c2d8e87e68f3af">TCP_CLOSING</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:313</div></div>
<div class="ttc" id="mos__api_8h_html_ae8e940088fba957e4ffe946d1d282bfc"><div class="ttname"><a href="mos__api_8h.html#ae8e940088fba957e4ffe946d1d282bfc">mtcp_unregister_callback</a></div><div class="ttdeci">int mtcp_unregister_callback(mctx_t mctx, int sock, event_t event, int hook_point)</div><div class="ttdoc">Remove registered callback functions. </div></div>
<div class="ttc" id="structpkt__info_html_ab7dadebb7b3d61e4dedacc1e76d3d667"><div class="ttname"><a href="structpkt__info.html#ab7dadebb7b3d61e4dedacc1e76d3d667">pkt_info::cur_ts</a></div><div class="ttdeci">uint32_t cur_ts</div><div class="ttdoc">packet receiving time (read-only:ro) </div><div class="ttdef"><b>Definition:</b> mos_api.h:123</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a27b22357288f66648687714ed749b494"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a27b22357288f66648687714ed749b494">MOS_FRAG_CLIBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:241</div></div>
<div class="ttc" id="mos__api_8h_html_a5414c55417e8dfda2a91e46eb341e6cd"><div class="ttname"><a href="mos__api_8h.html#a5414c55417e8dfda2a91e46eb341e6cd">mtcp_reset_conn</a></div><div class="ttdeci">int mtcp_reset_conn(mctx_t mctx, int sock)</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a7e936559d3a68bfaa3b2965e9e50df92"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a7e936559d3a68bfaa3b2965e9e50df92">MOS_SEQ_REMAP</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:239</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a592661443f4272c39d802ae7f6da10dd"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a592661443f4272c39d802ae7f6da10dd">MOS_ON_CONN_END</a></div><div class="ttdoc">A flow is about to be destroyed. </div><div class="ttdef"><b>Definition:</b> mos_api.h:87</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0abcd34c973e5569dfc054edbb8e1620e6"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0abcd34c973e5569dfc054edbb8e1620e6">MOS_ON_ORPHAN</a></div><div class="ttdoc">A packet is not SYN and has no identified flow. </div><div class="ttdef"><b>Definition:</b> mos_api.h:79</div></div>
<div class="ttc" id="mos__api_8h_html_a7d2d06e2b79da6a940cf1f22e2dd3113a9426a16f183cbc135ee25f0d60542e2f"><div class="ttname"><a href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a9426a16f183cbc135ee25f0d60542e2f">MOS_NULL</a></div><div class="ttdoc">Very first hooking point of incoming packet even before flow identification. </div><div class="ttdef"><b>Definition:</b> mos_api.h:35</div></div>
<div class="ttc" id="mos__api_8h_html_a181a35077bcf84ab3ec5f3827311b9bd"><div class="ttname"><a href="mos__api_8h.html#a181a35077bcf84ab3ec5f3827311b9bd">mtcp_app_join</a></div><div class="ttdeci">void mtcp_app_join(mctx_t mctx)</div><div class="ttdoc">Pause mtcp application context since it is not running anything. </div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a3b831e0fc2d31abed5830a98932de67a"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a3b831e0fc2d31abed5830a98932de67a">MOS_NULL_EVENT</a></div><div class="ttdoc">invalid event </div><div class="ttdef"><b>Definition:</b> mos_api.h:46</div></div>
<div class="ttc" id="structpkt__info_html_ab32fec05abd5d56189cd7dae19b693aa"><div class="ttname"><a href="structpkt__info.html#ab32fec05abd5d56189cd7dae19b693aa">pkt_info::iph</a></div><div class="ttdeci">struct iphdr * iph</div><div class="ttdef"><b>Definition:</b> mos_api.h:148</div></div>
<div class="ttc" id="structtcp__buf__info_html_a71120bd926e22d21d7522de2339b66bc"><div class="ttname"><a href="structtcp__buf__info.html#a71120bd926e22d21d7522de2339b66bc">tcp_buf_info::tcpbi_init_seq</a></div><div class="ttdeci">uint32_t tcpbi_init_seq</div><div class="ttdoc">The initial TCP sequence number of TCP ring buffer. </div><div class="ttdef"><b>Definition:</b> mos_api.h:257</div></div>
<div class="ttc" id="mos__api_8h_html_a6f6a3233eeb5df8d42227fc9761058d9"><div class="ttname"><a href="mos__api_8h.html#a6f6a3233eeb5df8d42227fc9761058d9">mtcp_get_debug_string</a></div><div class="ttdeci">int mtcp_get_debug_string(mctx_t mctx, char *buf, int len)</div></div>
<div class="ttc" id="structmtcp__context_html"><div class="ttname"><a href="structmtcp__context.html">mtcp_context</a></div><div class="ttdoc">mTCP context </div><div class="ttdef"><b>Definition:</b> mtcp_api.h:19</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a1751478d78b2a803cf6bdbcf52238da9"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a1751478d78b2a803cf6bdbcf52238da9">MOS_ON_PKT_IN</a></div><div class="ttdoc">A packet is coming in. </div><div class="ttdef"><b>Definition:</b> mos_api.h:49</div></div>
<div class="ttc" id="structtcp__ring__fragment_html"><div class="ttname"><a href="structtcp__ring__fragment.html">tcp_ring_fragment</a></div><div class="ttdoc">Structure to expose TCP ring buffer&#39;s fragment information. </div><div class="ttdef"><b>Definition:</b> mos_api.h:287</div></div>
<div class="ttc" id="structfilter__arg_html_accf6423cd30f80e1fa7f8960b037584e"><div class="ttname"><a href="structfilter__arg.html#accf6423cd30f80e1fa7f8960b037584e">filter_arg::len</a></div><div class="ttdeci">size_t len</div><div class="ttdef"><b>Definition:</b> mos_api.h:181</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8a4a9cd3145c63512d31a3953882b7a843"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8a4a9cd3145c63512d31a3953882b7a843">MOS_SVRBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:238</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0abe288d81191ad648dc75370e932592e3"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0abe288d81191ad648dc75370e932592e3">MOS_ON_ERROR</a></div><div class="ttdoc">Abnormal behavior is detected. </div><div class="ttdef"><b>Definition:</b> mos_api.h:71</div></div>
<div class="ttc" id="structpkt__info_html_a455911051c32d2a983470fd7d05f27b7"><div class="ttname"><a href="structpkt__info.html#a455911051c32d2a983470fd7d05f27b7">pkt_info::window</a></div><div class="ttdeci">uint16_t window</div><div class="ttdef"><b>Definition:</b> mos_api.h:136</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8abdb2ae22e09c899f60617e651a24fb93"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8abdb2ae22e09c899f60617e651a24fb93">MOS_FRAGINFO_SVRBUF</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:230</div></div>
<div class="ttc" id="mos__api_8h_html_a85786300e410493fd5539aa86ed2e105a680a81a7e7676aef8d747d1e06610633"><div class="ttname"><a href="mos__api_8h.html#a85786300e410493fd5539aa86ed2e105a680a81a7e7676aef8d747d1e06610633">TCP_CLOSED</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:305</div></div>
<div class="ttc" id="structpkt__info_html"><div class="ttname"><a href="structpkt__info.html">pkt_info</a></div><div class="ttdoc">struct pkt_info is the struct that is actually exposed to the monitor application. </div><div class="ttdef"><b>Definition:</b> mos_api.h:122</div></div>
<div class="ttc" id="mos__api_8h_html_aeecd455a2fb61cd6d8596939da635eb8ae986ab75d2756b4c7df5e17322e4500a"><div class="ttname"><a href="mos__api_8h.html#aeecd455a2fb61cd6d8596939da635eb8ae986ab75d2756b4c7df5e17322e4500a">MOS_TCP_STATE_SVR</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:234</div></div>
<div class="ttc" id="structpkt__ctx_html_a5df407bf1c8b6c30922baad4d61c2ae8"><div class="ttname"><a href="structpkt__ctx.html#a5df407bf1c8b6c30922baad4d61c2ae8">pkt_ctx::out_ifidx</a></div><div class="ttdeci">int8_t out_ifidx</div><div class="ttdoc">output interface (rw) </div><div class="ttdef"><b>Definition:</b> mos_api.h:163</div></div>
<div class="ttc" id="mos__api_8h_html_ac416f8592303eb59e172c94224485986"><div class="ttname"><a href="mos__api_8h.html#ac416f8592303eb59e172c94224485986">mtcp_peek</a></div><div class="ttdeci">ssize_t mtcp_peek(mctx_t mctx, int sock, int side, char *buf, size_t len)</div><div class="ttdoc">Peeking bytestream from flow_context. </div></div>
<div class="ttc" id="mos__api_8h_html_a0d07681632738288db8f90a55644e017"><div class="ttname"><a href="mos__api_8h.html#a0d07681632738288db8f90a55644e017">mtcp_getpeername</a></div><div class="ttdeci">int mtcp_getpeername(mctx_t mctx, int sock, struct sockaddr *saddr, socklen_t *addrlen, int side)</div><div class="ttdoc">Get IP addrs/ports for both sides. </div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a6c97d773b78bf6c7f68480a8a1a8a705"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a6c97d773b78bf6c7f68480a8a1a8a705">MOS_ON_REXMIT</a></div><div class="ttdoc">Retransmission is detected. </div><div class="ttdef"><b>Definition:</b> mos_api.h:81</div></div>
<div class="ttc" id="structseq__remap__info_html_a33b59e1b5265cb3ff92184005269b3c9"><div class="ttname"><a href="structseq__remap__info.html#a33b59e1b5265cb3ff92184005269b3c9">seq_remap_info::side</a></div><div class="ttdeci">int side</div><div class="ttdef"><b>Definition:</b> mos_api.h:175</div></div>
<div class="ttc" id="mtcp__api_8h_html_a0c8186d9b9b7880309c27230bbb5e69d"><div class="ttname"><a href="mtcp__api_8h.html#a0c8186d9b9b7880309c27230bbb5e69d">byte</a></div><div class="ttdeci">unsigned char byte</div><div class="ttdef"><b>Definition:</b> mtcp_api.h:12</div></div>
<div class="ttc" id="mos__api_8h_html_a06fc87d81c62e9abb8790b6e5713c55bab47cd36b4c58d42c4757ab3935d8d765"><div class="ttname"><a href="mos__api_8h.html#a06fc87d81c62e9abb8790b6e5713c55bab47cd36b4c58d42c4757ab3935d8d765">MOS_SIDE_BOTH</a></div><div class="ttdef"><b>Definition:</b> mos_api.h:322</div></div>
<div class="ttc" id="mos__api_8h_html_ac74da39802fdb6e33e2d7011d1d6195e"><div class="ttname"><a href="mos__api_8h.html#ac74da39802fdb6e33e2d7011d1d6195e">monitor_filter_t</a></div><div class="ttdeci">union monitor_filter * monitor_filter_t</div><div class="ttdef"><b>Definition:</b> mos_api.h:343</div></div>
<div class="ttc" id="mos__api_8h_html_a6e51c3e428808a66bbf94a24d92c98a0a871cd398c491bdc45ef8f75066d44776"><div class="ttname"><a href="mos__api_8h.html#a6e51c3e428808a66bbf94a24d92c98a0a871cd398c491bdc45ef8f75066d44776">MOS_ON_PKT_OUT</a></div><div class="ttdoc">A packet is going out. </div><div class="ttdef"><b>Definition:</b> mos_api.h:52</div></div>
<div class="ttc" id="structfilter__arg_html_a2b1bb9a93d2ca8bcb6ec7e5892cc0f85"><div class="ttname"><a href="structfilter__arg.html#a2b1bb9a93d2ca8bcb6ec7e5892cc0f85">filter_arg::arg</a></div><div class="ttdeci">void * arg</div><div class="ttdef"><b>Definition:</b> mos_api.h:180</div></div>
<div class="ttc" id="mos__api_8h_html_a7d2d06e2b79da6a940cf1f22e2dd3113a4401938e02f5dc902e44e652e7e20753"><div class="ttname"><a href="mos__api_8h.html#a7d2d06e2b79da6a940cf1f22e2dd3113a4401938e02f5dc902e44e652e7e20753">MOS_HK_RCV</a></div><div class="ttdoc">Hooking point before TCP receiver. </div><div class="ttdef"><b>Definition:</b> mos_api.h:37</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri Jan 29 2016 19:28:36 for mOS API description by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9
</small></address>
</body>
</html>
